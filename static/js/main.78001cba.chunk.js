(this["webpackJsonpwhite-tent"]=this["webpackJsonpwhite-tent"]||[]).push([[4],{26:function(e,t,n){"use strict";n.d(t,"g",(function(){return l})),n.d(t,"j",(function(){return d})),n.d(t,"h",(function(){return h})),n.d(t,"i",(function(){return j})),n.d(t,"c",(function(){return f})),n.d(t,"e",(function(){return p})),n.d(t,"b",(function(){return x})),n.d(t,"f",(function(){return O})),n.d(t,"d",(function(){return v})),n.d(t,"a",(function(){return g}));var c=n(22),i=n.n(c),a=n(31),o=n(30),r=n(18);n(50),n(69),n(70);r.a.initializeApp({apiKey:"AIzaSyB8qsuIokGL2JnLg4wEiQLUHIWUUgmTBTY",authDomain:"white-tent-c2b34.firebaseapp.com",projectId:"white-tent-c2b34",storageBucket:"white-tent-c2b34.appspot.com",messagingSenderId:"89645161876",appId:"1:89645161876:web:ee1a6a38ed8c8ef5db8381"});var s=r.a.firestore();function l(){return null!=r.a.auth().currentUser}function u(e,t){var n=r.a.auth().currentUser;null!=n?s.collection("users").doc(n.uid).get().then((function(c){if(c.exists){var i=c.data();i.uid=n.uid,i.created_at=i.created_at.toDate(),e(i)}else t("User data does not exists")})).catch((function(e){t(e)})):t("null")}function d(e,t,n,c,i){r.a.auth().createUserWithEmailAndPassword(e,t).then((function(t){var a=t.user;n.email=e,n.created_at=r.a.firestore.FieldValue.serverTimestamp(),s.collection("users").doc(a.uid).set(n).then((function(){u(c,i)})).catch((function(e){i(e)}))})).catch((function(e){i(e)}))}function h(e,t,n,c){r.a.auth().signInWithEmailAndPassword(e,t).then((function(e){u(n,c)})).catch((function(e){c(e)}))}function j(e,t){r.a.auth().signOut().then((function(){e()})).catch((function(e){t(e)}))}function b(e,t,n,c){e=e*Math.PI/180,t=t*Math.PI/180;var i=e-(n=n*Math.PI/180),a=t-(c=c*Math.PI/180),o=Math.pow(Math.sin(i/2),2)+Math.cos(e)*Math.cos(n)*Math.pow(Math.sin(a/2),2),r=2*Math.asin(Math.sqrt(o));return Math.round(6371*r*10)/10}function f(e,t,n,c){var i=[];s.collection("shop").get().then((function(c){c.forEach((function(n){var c=n.data();c.distance=b(e,t,c.coordinate.latitude,c.coordinate.longitude),i.push({shop_id:n.id,name:c.name,distance:c.distance,photo_url:c.photo_url})})),i.sort((function(e,t){return e.distance<t.distance?-1:1})),n(i)})).catch((function(e){c(e)}))}function p(e,t){s.collection("shop_category").get().then((function(t){var n={};t.forEach((function(e){n[e.id]=e.data()})),e(n)})).catch((function(e){return t(e)}))}function x(e,t){s.collectionGroup("products").get().then((function(t){var n=[];t.forEach((function(e){n.push(e.data())})),n.sort((function(e,t){var n,c;return(null!==(n=e.total_likes)&&void 0!==n?n:-1)>(null!==(c=t.total_likes)&&void 0!==c?c:-1)?-1:1})),e(n.slice(0,10))})).catch((function(e){return t(e)}))}function O(e,t,n,c){s.collection("shop").doc(e).get().then((function(e){if(e.exists){var i=e.data(),a=t.longitude,r=b(t.latitude,a,i.coordinate.latitude,i.coordinate.longitude);n(Object(o.a)(Object(o.a)({},e.data()),{},{distance:r}))}else c("Error: shop id does not exists")})).catch((function(e){c(e)}))}function v(e,t,n){s.collection("shop").doc(e).collection("products").get().then((function(e){if(e.empty)n("Error: shop id does not exists or there are no products");else{var c={};e.forEach((function(e){var t=e.data();t.product_id=e.id,t.categories.forEach((function(e){e in c||(c[e]=[]),c[e].push(t)}))})),t(c)}})).catch((function(e){n(e)}))}function g(e,t,n){var c=r.a.auth().currentUser;if(null!=c){var o=s.collection("counter").doc("order"),l=s.collection("counter").doc("total_save"),u=s.collection("users").doc(c.uid).collection("order").doc();s.runTransaction(function(){var t=Object(a.a)(i.a.mark((function t(n){var c,a,s,d;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.get(o);case 2:return c=t.sent,t.next=5,n.get(l);case 5:return a=t.sent,s=c.data().value+1,d=a.data().value+e.total_save,e.order_id="WT_".concat(s),e.created_at=r.a.firestore.FieldValue.serverTimestamp(),e.status="active",n.set(u,e),n.update(o,{value:s}),n.update(l,{value:d}),t.abrupt("return",Promise.resolve(!0));case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).then((function(){u.get().then((function(e){var n=e.data();n.created_at=n.created_at.toDate(),t(n)})).catch((function(e){n(e)}))})).catch((function(e){n(e)}))}else n("Error: User not logged in")}},48:function(e,t,n){},54:function(e,t,n){},68:function(e,t,n){"use strict";n.r(t);var c=n(0),i=n.n(c),a=n(19),o=n.n(a),r=(n(48),n(27)),s=n(26),l=(n(54),n(55),n(17)),u=n(9),d=n(16),h=n(37),j=n(36),b=n.p+"static/media/logo-white.02d4cb1e.svg",f=n(3),p=i.a.lazy((function(){return n.e(10).then(n.bind(null,99))})),x=i.a.lazy((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(11)]).then(n.bind(null,95))})),O=i.a.lazy((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(9)]).then(n.bind(null,96))})),v=i.a.lazy((function(){return Promise.all([n.e(0),n.e(3),n.e(7)]).then(n.bind(null,100))})),g=i.a.lazy((function(){return Promise.all([n.e(3),n.e(8)]).then(n.bind(null,97))})),m=i.a.lazy((function(){return Promise.all([n.e(0),n.e(12)]).then(n.bind(null,101))}));var k=function(){var e=Object(c.useState)(!1),t=Object(r.a)(e,2),n=t[0],i=t[1],a=Object(c.useState)(!1),o=Object(r.a)(a,2),k=o[0],y=o[1],w=Object(c.useRef)(null),_=Object(s.g)();Object(c.useEffect)((function(){i(_)}),[_]);var S=Object(f.jsx)("div",{style:{width:"100%",height:"50vh",display:"flex",justifyContent:"center",alignItems:"center"},children:Object(f.jsx)(j.a,{size:"large",type:"infinite-spinner"})});return Object(f.jsx)("div",{className:"App",children:Object(f.jsxs)(l.a,{children:[Object(f.jsxs)(d.a,{themeColor:"dark",children:[Object(f.jsx)(d.b,{style:{position:"absolute",left:"50%",transform:"translate(-50%)"},children:Object(f.jsx)(l.b,{to:"/",style:{height:"24px"},children:Object(f.jsx)("img",{src:b,alt:"whitetent-logo-white"})})}),Object(f.jsx)(d.c,{}),Object(f.jsx)("div",{className:"nav-links-mobile",children:Object(f.jsxs)(d.b,{children:[Object(f.jsx)("button",{ref:w,className:"k-button k-button-clear",style:{color:"white"},onClick:function(){y(!k)},children:Object(f.jsx)("span",{className:"k-icon k-i-menu"})}),Object(f.jsx)(h.a,{anchor:w.current,show:k,style:{marginLeft:-10},children:Object(f.jsx)("div",{className:"popup-content",children:n?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("div",{className:"popup-nav-link",children:Object(f.jsx)(l.b,{to:"/login",style:{textDecoration:"none"},children:"Shops"})}),Object(f.jsx)("div",{className:"popup-nav-link",children:Object(f.jsx)(l.b,{to:"/login",style:{textDecoration:"none"},children:"Favourites"})}),Object(f.jsx)("div",{className:"popup-nav-link",style:{fontWeight:"bold"},onClick:function(){Object(s.i)((function(e){window.location.reload()}),(function(e){console.error(e)}))},children:"Logout"})]}):Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("div",{className:"popup-nav-link",children:Object(f.jsx)(l.b,{to:"/login",style:{textDecoration:"none"},children:"Login"})}),Object(f.jsx)("div",{className:"popup-nav-link",children:Object(f.jsx)(l.b,{to:"/signup",style:{textDecoration:"none"},children:"Signup"})})]})})})]})}),Object(f.jsx)("div",{className:"nav-links",children:n?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(d.b,{children:Object(f.jsx)("ul",{children:Object(f.jsx)("li",{children:Object(f.jsx)(l.b,{to:"/shops",style:{color:"white",textDecoration:"none"},children:"Shops"})})})}),Object(f.jsx)(d.b,{children:Object(f.jsx)("span",{className:"k-appbar-separator"})}),Object(f.jsx)(d.b,{children:Object(f.jsx)("ul",{children:Object(f.jsx)("li",{children:Object(f.jsx)(l.b,{to:"/favourites",style:{color:"white",textDecoration:"none"},children:"Favourites"})})})})]}):Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(d.b,{children:Object(f.jsx)("ul",{children:Object(f.jsx)("li",{children:Object(f.jsx)(l.b,{to:"/login",style:{color:"white",textDecoration:"none"},children:"Login"})})})}),Object(f.jsx)(d.b,{children:Object(f.jsx)("span",{className:"k-appbar-separator"})}),Object(f.jsx)(d.b,{children:Object(f.jsx)("ul",{children:Object(f.jsx)("li",{children:Object(f.jsx)(l.b,{to:"/signup",style:{color:"white",textDecoration:"none"},children:"Signup"})})})})]})})]}),Object(f.jsx)("div",{children:Object(f.jsxs)(u.c,{children:[Object(f.jsx)(u.a,{path:"/login",children:Object(f.jsx)(c.Suspense,{fallback:S,children:Object(f.jsx)(x,{})})}),Object(f.jsx)(u.a,{path:"/signup",children:Object(f.jsx)(c.Suspense,{fallback:S,children:Object(f.jsx)(O,{})})}),Object(f.jsx)(u.a,{path:"/store/:id",children:Object(f.jsx)(c.Suspense,{fallback:S,children:Object(f.jsx)(v,{})})}),Object(f.jsx)(u.a,{path:"/order/:id",children:Object(f.jsx)(c.Suspense,{fallback:S,children:Object(f.jsx)(g,{})})}),Object(f.jsx)(u.a,{path:"/transaction/:id",children:Object(f.jsx)(c.Suspense,{fallback:S,children:Object(f.jsx)(m,{})})}),Object(f.jsx)(u.a,{path:"/",exact:!0,children:Object(f.jsx)(c.Suspense,{fallback:S,children:Object(f.jsx)(p,{})})})]})})]})})},y=function(e){e&&e instanceof Function&&n.e(13).then(n.bind(null,98)).then((function(t){var n=t.getCLS,c=t.getFID,i=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),c(e),i(e),a(e),o(e)}))},w=n(42),_=n(43),S=Object(_.a)({reducer:{}});o.a.render(Object(f.jsx)(i.a.StrictMode,{children:Object(f.jsx)(w.a,{store:S,children:Object(f.jsx)(k,{})})}),document.getElementById("root")),y()}},[[68,5,6]]]);
//# sourceMappingURL=main.78001cba.chunk.js.map